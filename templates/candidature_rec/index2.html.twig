{% extends 'base.html.twig' %}

{% block title %}Candidature index{% endblock %}

{% block body %}
    <h1>Candidature index</h1>

    <table class="table">
        <thead>
            <tr>

                <th>Date de postulation</th>
                <th>Candidat</th>
                <th>Etat Candidature</th>
                <th>Date et heure du rendez vous</th>
                <th>Commentaire du rendez vous</th>
                <th>En ligne </th>
                <th>Place ou Link</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for candidature in candidatures %}

            <tr>
            
            {% if candidature.etatCandidature == 0 %}
            {% set h = candidature.OffreEmploi.getIdRecruteur() %}
            {% set s = h.id  %} 


            {% if s ==  app.user.id %}


                <td>{{ candidature.DateCreation ? candidature.DateCreation|date('Y-m-d') : '' }}</td>
                <td>{{ candidature.user.NomUtilisateur}}</td>
                <td>{{ candidature.etatCandidature ? 'Acceptée' : 'En attente' }}</td>
                {% if candidature.RendezVousEnligne != null %}
                <td>{{ candidature.RendezVousDateTime ? candidature.RendezVousDateTime|date('Y-m-d H:i:s') : '' }}</td>
                <td>{{ candidature.RendezVousComment }}</td>
                <td>{{ candidature.RendezVousEnligne ? 'Oui' : 'Non' }}</td>
                <td>{{ candidature.RendezVousPlaceLink }}</td>
                {% else %}
                <td>Pas encore crée </td>
                <td>Pas encore crée</td>
                <td>Pas encore crée</td>
                <td>Pas encore crée</td>
                 {% endif %}
                {% endif %}
                <td>
                    <a href="{{ path('candidature_rec_show', {'id': candidature.id}) }}">show</a>
                    {% if candidature.etatCandidature == 1 %}
                    <a href="{{ path('candidature_rec_edit', {'id': candidature.id}) }}">Valider</a> {# tsir creation mta3 rendez vous w validation  #}
                    <a href="{{ path('candidature_rec_Refuser', {'id': candidature.id}) }}">Réfuser Candidature</a> {# etat te5ou 2 #}
                    {% endif %}
                    {% if candidature.RendezVousEnligne != null %}
                    <a href="{{ path('SupprimerRV', {'id': candidature.id}) }}">Supprimer Rendez Vous</a> {# ken fama rendez vous tsir suppression / deja validé  #}
                    {% endif %}

                    {% if candidature.RendezVousEnligne == null %} {# validé ama render vous supprimer donc ynajm yaawed yaamel rendez vous  #}
                    {% if candidature.etatCandidature == 2  %}
                    <a href="{{ path('candidature_rec_edit', {'id': candidature.id}) }}">Créer Rendez Vous</a> 
                    {% endif %}
                    {% endif %}


                </td>
                
            </tr>
                {% if candidature.etatCandidature != 0 %}
                    <tr>
                <td colspan="8">Pas de candidatures</td>
            </tr>
            {% endif %}

        {% else %}

            <tr>
                <td colspan="8">Pas de candidatures</td>
            </tr>
            {% endif %}
        {% endfor %}

        </tbody>
    </table>

{% endblock %}
